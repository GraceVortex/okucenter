@echo off
chcp 65001
python manage.py shell -c "from accounts.models import Student; from classes.models import ClassSchedule; from django.utils import timezone; today = timezone.now().date(); day_of_week = today.weekday(); print(f'Сегодня: {today}, день недели: {day_of_week}'); students = Student.objects.filter(full_name__icontains='Dulat'); print(f'Найдено студентов: {students.count()}'); [print(f'Студент: {s.full_name}, ID: {s.id}') for s in students]; student = students.first(); if student: enrollments = student.enrollments.filter(is_active=True); print(f'Активные записи: {enrollments.count()}'); class_ids = [e.class_obj_id for e in enrollments]; print(f'ID классов: {class_ids}'); schedules = ClassSchedule.objects.filter(class_obj_id__in=class_ids, day_of_week=day_of_week); print(f'Занятия на сегодня: {schedules.count()}'); [print(f'Занятие: {s.class_obj.name}, {s.start_time}-{s.end_time}') for s in schedules.select_related('class_obj')]"
